<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manage Profiles - Netflix Clone</title>
    <link rel="stylesheet" href="/css/profiles.css">
    <link rel="stylesheet" href="/css/manage-profiles.css">
</head>
<body data-user-id="<%= user.id %>">
    <!-- Single Main Container -->
    <div class="manage-profiles-container">
        <!-- Header with logo and back button -->
        <div class="header">
            <img src="/resources/netflix_logo.png" alt="Netflix Logo" class="logo">
            <button class="back-button" onclick="goBack()">‚Üê Back to Profiles</button>
        </div>

        <!-- Page Title -->
        <h1 class="page-title"><%= user.username %>'s Profiles</h1>
        
        <!-- Add Profile Section -->
        <div class="add-profile-section">
            <h2>Add New Profile</h2>
            <div class="add-profile-form">
                <input 
                    type="text" 
                    id="profileNameInput" 
                    placeholder="Enter profile name (max 12 characters)"
                    maxlength="20"
                    class="profile-name-input"
                >
                <button 
                    id="addProfileBtn" 
                    class="add-profile-btn"
                    onclick="addNewProfile()"
                >
                    Add Profile
                </button>
            </div>
            <div id="addProfileMessage" class="message"></div>
            
            <!-- Current Profiles List -->
            <div class="current-profiles">
                <h3>Current Profiles (<span id="profileCount"><%= profiles.length %></span>/5)</h3>
                <ul class="profiles-list" id="profilesList">
                    <% profiles.forEach(function(profile) { %>
                        <li class="profile-item" data-profile-id="<%= profile.id %>">
                            <img src="<%= profile.avatar %>" alt="<%= profile.name %>" class="profile-avatar">
                            <span class="profile-name"><%= profile.name %></span>
                            <div class="profile-actions">
                                <button class="edit-btn" onclick="editProfile(<%= profile.id %>, '<%= JSON.stringify(profile.name) %>')">
                                    Edit
                                </button>
                                <button class="delete-btn" onclick="deleteProfile(<%= profile.id %>, '<%= JSON.stringify(profile.name) %>')">
                                    Delete
                                </button>
                            </div>
                        </li>
                    <% }); %>
                </ul>
            </div>
        </div>
    </div>

    <!-- Edit Profile Modal -->
    <div id="editModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Edit Profile</h3>
                <span class="close" onclick="closeEditModal()">&times;</span>
            </div>
            <div class="modal-body">
                <label for="editProfileName">Profile Name:</label>
                <input 
                    type="text" 
                    id="editProfileName" 
                    maxlength="12"
                    class="edit-profile-input"
                >
                <div id="editProfileMessage" class="message"></div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel-btn" onclick="closeEditModal()">Cancel</button>
                <button class="modal-btn save-btn" onclick="saveProfileEdit()">Save Changes</button>
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="deleteModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Delete Profile</h3>
                <span class="close" onclick="closeDeleteModal()">&times;</span>
            </div>
            <div class="modal-body">
                <p id="deleteConfirmText">Are you sure you want to delete this profile?</p>
                <div id="deleteProfileMessage" class="message"></div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel-btn" onclick="closeDeleteModal()">Cancel</button>
                <button class="modal-btn delete-btn-confirm" onclick="confirmDeleteProfile()">Delete Profile</button>
            </div>
        </div>
    </div>

    <script src="/js/manage-profiles.js"></script>
</body>
</html>